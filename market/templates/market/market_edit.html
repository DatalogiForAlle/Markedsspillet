{% extends "market/base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Indstillinger{% endblock %}

{% block content %}

<h3 class="mb-4">
    Markedsindstillinger <span class="text-black-50">[{{ market.market_id }}]</span> 
</h3>

{% if not market.game_over %}
	<p class="mt-0">
		Nedenfor har du mulighed for at redigere de fleste af indstillingerne for dit marked. 
		Ændringer vil træde i kraft fra denne runde og frem.<br>
	</p>
{% endif %}
<br>

<form class="mb-5" method="POST" id="edit-market-form"  action="{% url 'market:market_edit' market.market_id %}">
    {% csrf_token %}
    {{ form|crispy }}
    <div class="d-flex justify-content-between mt-5">
        <a href="{% url 'market:monitor' market.market_id %}" class="btn btn-primary">Tilbage</a>
		{% if not market.game_over %}
		<button class="btn btn-warning" type="button" onclick="submit_form()">Opdater</button>
		{% endif %}
    </div>
</form>
{% endblock content %}

{% block javascript %}

<!-- Import scripts shared with market-create page -->
<script src="{% static "create-update-market-helpers.js" %}"></script>

<script>
	market_form = document.getElementById('edit-market-form');
   
	document.getElementById('div_id_endless').addEventListener('change', function() {
		adjust_max_round_field()
	}); 			

	adjust_max_round_field()
	
	{% if market.game_over %}
		document.getElementById("id_product_name_singular").setAttribute('readonly', true)
		document.getElementById("id_product_name_plural").setAttribute('readonly', true)
		document.getElementById("id_max_rounds").setAttribute('readonly', true)
		document.getElementById("id_alpha").setAttribute('readonly', true)
		document.getElementById("id_gamma").setAttribute('readonly', true)
		document.getElementById("id_theta").setAttribute('readonly', true)
		document.getElementById("id_endless").setAttribute('disabled', 'disabled')
	{% endif %} 
</script>

{% endblock javascript %}

