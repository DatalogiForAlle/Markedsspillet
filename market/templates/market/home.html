{% extends "market/base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Home{% endblock %}

{% block content %}

<h4 class="mb-4">Velkommen til Markedsspillet!</h4>

<div class="row">
    <!-- Col with options for "traders" -->
    <div class="col col-12 col-lg-6">
        <div class="card">
            <div class="card-header">Deltag i et marked</div>
            
            <div class="card-body container">
            
                {% if request.session.market_id and not request.session.removed_from_market %}
                    <!-- Warn users who have already joined a market -->
                    <div class="alert alert-warning">
                        Hej {{ request.session.username }}! Du deltager allerede i {{ market.product_name_singular}}-markedet  <a href="{% url 'market:play' market.market_id %}">{{ market.market_id }}</a>.
                        Hvis du indsender formularen nedenfor, mister du permanent adgang til dette marked.                      
                    </div>
                {% endif %} 
                    <!-- Content if client has not joined a market -->
                    <form action="{% url 'market:join_market' %}" method="post">{% csrf_token %}
                        {{ form|crispy }}
                        <div class="d-flex justify-content-center">
                            <input type="submit" value="Deltag i marked" class="btn btn-primary my-2">
                        </div>
                    </form>
            </div>
        </div>
    </div>
    <!-- Col with options for "hosts" -->
    
    <div class="col col-12 col-lg-6 mt-5 mb-3 my-lg-0">
        <div class="card mb-4">
            <div class="card-header">
                Opret et nyt marked
            </div>
            <div class="card-body container">
                {% if user.is_authenticated %}     

                <p>Opret et marked, hvis du ønsker at være game master for et markedsspil med andre deltagere: </p>
                <div class="d-flex justify-content-center mb-4">
                    <a class="pr-2" href="{% url 'market:create_market' %}">
                        <button class="btn btn-primary">
                            Opret nyt marked
                        </button>
                    </a>
                </div>
                <p class="mt-3">Her kan du finde de markeder, du evt. har oprettet tidligere:</p>
                <div class="d-flex justify-content-center p">
                    <a class="pl-2 mb-3" href="{% url 'market:my_markets' %}">
                        <button class="btn btn-primary">
                            Mine markeder
                        </button>
                    </a>
                </div>

                {% else %}
                <p class="mt-2">Når du opretter et nyt marked, får du automatisk rollen som 'game master'. Ønsker du at oprette et nyt marked?
                Eller genbesøge et marked, du oprettede tidligere?</p>                            
                <div class="d-flex justify-content-center p">
                    <a class="mr-2" href="{% url 'account_login' %}">
                        <button class="btn btn-primary">
                                Log på      
                        </button>
                    </a>
                </div>
    
                <p class="mt-4">Hvis du ikke har en konto, kan du oprette en her: </p>                            

                <div class="d-flex mb-2 justify-content-center">
            
                    <a class="ml-2" href="{% url 'account_signup' %}">
                        <button class="btn btn-primary">
                            Opret ny konto      
                        </button>
                    </a>
                </div>
                
                {% endif %}
            </div>
        </div>
    </div>
</div>

<nav class="pt-2 mt-5 fixed-bottom bg-light py-3 py-lg-5 d-none d-md-block" style="z-index: -1;">
    <div class="container">
        <div class="d-flex text-center justify-content-center justify-content-md-between flex-column flex-md-row">
            <a href="https://dataekspeditioner.dk/"><img src="{% static 'img/dataekspeditioner_sort.png' %}" class="pt-4 pb-5 pb-md-0" width="260" alt="dataekspeditioner-logo"></a>
            <a href="https://ku.dk"><img src="{% static 'img/ku_logo_dk_hh-300x112.png' %}" class="px-0 px-md-5 pb-md-0 pb-5" width="300"  alt="Københavns Universitet"></a>
            <a href="https://novonordiskfonden.dk/da/"><img src="{% static 'img/NNF_blue_RGB_solid.png' %}" class="pr-3" width="130" alt="Novo Nordisk Fonden"></a> 
        </div>
    </div>
</nav>  

{% endblock content %}





{% block javascript%}

{% if request.session.market_id %}
    <script>
        // if client has already joined a game, fill out name field
        document.getElementById('id_name').value = "{{ request.session.username }}"
    </script>
{% endif %}

{% endblock javascript%}
    